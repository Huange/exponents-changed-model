function [p0,p1,p2,p3,p4,p5,p6,p7,p8] = P_nonact_modified_3(p,q,r,l,d)

P_total = 0;
p4 = 0;
p5 = 0;
p6 = 0;
p7 = 0;
p8 = 0;

%m + n + k =0
P_0 = (1-p)^nthroot(l,d) * (1-q)^nthroot(l,d) * (1-r)^nthroot(l,d);
P_total = P_total + P_0;

% m + n + k =1
P_1k = (1-p)^nthroot(l,d) * (1-q)^nthroot(l,d) * size(nchoosek(1:l,1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_1n = (1-p)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d);
P_1m = (1-q)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d);
P_1 = P_1k + P_1n + P_1m;
P_total = P_total + P_1;

% m + n + k =2
P_2m = (1-q)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d);
P_2n = (1-p)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d);
P_2k = (1-p)^nthroot(l,d) * (1-q)^nthroot(l,d) * size(nchoosek(1:l,2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_2mn = (1-r)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d);
P_2mk = (1-q)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_2nk = (1-p)^nthroot(l,d) * size(nchoosek(1:l,1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-1),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_2 = P_2m + P_2n + P_2k + P_2mn + P_2mk + P_2nk;
P_total = P_total + P_2;

% m + n + k =3
P_3m = (1-q)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d);
P_3n = (1-p)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d);
P_3k = (1-p)^nthroot(l,d) * (1-q)^nthroot(l,d) * size(nchoosek(1:l,3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_3mn = (1-r)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d);
P_3nm = (1-r)^nthroot(l,d) * size(nchoosek(1:l,2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-2),1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d);
P_3mk = (1-q)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_3km = (1-q)^nthroot(l,d) * size(nchoosek(1:l,2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d) * size(nchoosek(1:(l-2),1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d);
P_3nk = (1-p)^nthroot(l,d) * size(nchoosek(1:l,2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-2),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_3kn = (1-p)^nthroot(l,d) * size(nchoosek(1:l,2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d) * size(nchoosek(1:(l-2),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d);
P_3mnk = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-2),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_3 = P_3m + P_3n + P_3k + P_3mn + P_3nm + P_3mk + P_3km + P_3nk + P_3kn + P_3mnk;
P_total = P_total + P_3;
p0 = P_0/P_total;
p1 = P_1/P_total;
p2 = P_2/P_total;
p3 = P_3/P_total;

% m + n + k =4
if l > 3
P_4m = (1-q)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d);
P_4n = (1-p)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d);
P_4k = (1-p)^nthroot(l,d) * (1-q)^nthroot(l,d) * size(nchoosek(1:l,4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_4mn1 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d);
P_4mn2 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d);
P_4mn3 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d);
P_4mk1 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_4mk2 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_4mk3 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_4nk1 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-3),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_4nk2 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-2),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_4nk3 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-1),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_4mnk1 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-3),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_4mnk2 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-3),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_4mnk3 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-2),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_4 = P_4m + P_4n + P_4k + P_4mn1 + P_4mn2 + P_4mn3 + P_4mk1 + P_4mk2 + P_4mk3 + P_4nk1 + P_4nk2 + P_4nk3 + P_4mnk1 + P_4mnk2 + P_4mnk3;
P_total = P_total + P_4;
p0 = P_0/P_total;
p1 = P_1/P_total;
p2 = P_2/P_total;
p3 = P_3/P_total;
p4 = P_4/P_total;
end

% m + n + k =5
if l > 4
P_5m = (1-q)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,5),1)*p^nthroot(5,d)*(1-p)^nthroot((l-5),d);
P_5n = (1-p)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,5),1)*q^nthroot(5,d)*(1-q)^nthroot((l-5),d);
P_5k = (1-p)^nthroot(l,d) * (1-q)^nthroot(l,d) * size(nchoosek(1:l,5),1)*r^nthroot(5,d)*(1-r)^nthroot((l-5),d);
P_5mn1 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d);
P_5mn2 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d);
P_5mn3 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d);
P_5mn4 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d);
P_5mk1 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_5mk2 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_5mk3 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_5mk4 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_5nk1 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d) * size(nchoosek(1:(l-4),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_5nk2 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-3),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_5nk3 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-2),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_5nk4 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-1),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_5mnk1 = size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-4),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_5mnk2 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-4),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_5mnk3 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-2),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_5mnk4 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-4),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_5mnk5 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-3),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_5mnk6 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-3),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_5 = P_5m + P_5n + P_5k + P_5mn1 + P_5mn2 + P_5mn3 + P_5mn4 + P_5mk1 + P_5mk2 + P_5mk3 + P_5mk4 + P_5nk1 + P_5nk2 + P_5nk3 + P_5nk4 + P_5mnk1 + P_5mnk2 + P_5mnk3 + P_5mnk4 + P_5mnk5 + P_5mnk6;
P_total = P_total + P_5;
p0 = P_0/P_total;
p1 = P_1/P_total;
p2 = P_2/P_total;
p3 = P_3/P_total;
p4 = P_4/P_total;
p5 = P_5/P_total;
end

% m + n + k =6
if l > 5
P_6m = (1-q)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,6),1)*p^nthroot(6,d)*(1-p)^nthroot((l-6),d);
P_6n = (1-p)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,6),1)*q^nthroot(6,d)*(1-q)^nthroot((l-6),d);
P_6k = (1-p)^nthroot(l,d) * (1-q)^nthroot(l,d) * size(nchoosek(1:l,6),1)*r^nthroot(6,d)*(1-r)^nthroot((l-6),d);
P_6mn1 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,5),1)*p^nthroot(5,d)*(1-p)^nthroot((l-5),d) * size(nchoosek(1:(l-5),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d);
P_6mn2 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d);
P_6mn3 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d);
P_6mn4 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d);
P_6mn5 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),5),1)*q^nthroot(5,d)*(1-q)^nthroot((l-5),d);
P_6mk1 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,5),1)*p^nthroot(5,d)*(1-p)^nthroot((l-5),d) * size(nchoosek(1:(l-5),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_6mk2 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_6mk3 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_6mk4 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_6mk5 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),5),1)*r^nthroot(5,d)*(1-r)^nthroot((l-5),d);
P_6nk1 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,5),1)*q^nthroot(5,d)*(1-q)^nthroot((l-5),d) * size(nchoosek(1:(l-5),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_6nk2 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d) * size(nchoosek(1:(l-4),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_6nk3 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-3),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_6nk4 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-2),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_6nk5 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-1),5),1)*r^nthroot(5,d)*(1-r)^nthroot((l-5),d);
P_6mnk1 = size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-5),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_6mnk2 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d) * size(nchoosek(1:(l-5),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_6mnk3 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-2),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_6mnk4 = size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-5),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_6mnk5 = size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-4),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_6mnk6 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-5),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_6mnk7 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-3),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_6mnk8 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-4),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_6mnk9 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-3),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_6mnk10 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-4),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_6 = P_6m + P_6n + P_6k + P_6mn1 + P_6mn2 + P_6mn3 + P_6mn4 + P_6mn5 + P_6mk1 + P_6mk2 + P_6mk3 + P_6mk4 + P_6mk5 + P_6nk1 + P_6nk2 + P_6nk3 + P_6nk4 + P_6nk5 + P_6mnk1 + P_6mnk2 + P_6mnk3 + P_6mnk4 + P_6mnk5 + P_6mnk6 + P_6mnk7 + P_6mnk8 + P_6mnk9 + P_6mnk10;
P_total = P_total + P_6;
p0 = P_0/P_total;
p1 = P_1/P_total;
p2 = P_2/P_total;
p3 = P_3/P_total;
p4 = P_4/P_total;
p5 = P_5/P_total;
p6 = P_6/P_total;
end

% m + n + k =7
if l > 6
P_7m = (1-q)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,7),1)*p^nthroot(7,d)*(1-p)^nthroot((l-7),d);
P_7n = (1-p)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,7),1)*q^nthroot(7,d)*(1-q)^nthroot((l-7),d);
P_7k = (1-p)^nthroot(l,d) * (1-q)^nthroot(l,d) * size(nchoosek(1:l,7),1)*r^nthroot(7,d)*(1-r)^nthroot((l-7),d);
P_7mn1 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,6),1)*p^nthroot(6,d)*(1-p)^nthroot((l-6),d) * size(nchoosek(1:(l-6),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d);
P_7mn2 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,5),1)*p^nthroot(5,d)*(1-p)^nthroot((l-5),d) * size(nchoosek(1:(l-5),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d);
P_7mn3 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d);
P_7mn4 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d);
P_7mn5 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),5),1)*q^nthroot(5,d)*(1-q)^nthroot((l-5),d);
P_7mn6 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),6),1)*q^nthroot(6,d)*(1-q)^nthroot((l-6),d);
P_7mk1 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,6),1)*p^nthroot(6,d)*(1-p)^nthroot((l-6),d) * size(nchoosek(1:(l-6),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_7mk2 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,5),1)*p^nthroot(5,d)*(1-p)^nthroot((l-5),d) * size(nchoosek(1:(l-5),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_7mk3 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_7mk4 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_7mk5 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),5),1)*r^nthroot(5,d)*(1-r)^nthroot((l-5),d);
P_7mk6 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),6),1)*r^nthroot(6,d)*(1-r)^nthroot((l-6),d);
P_7nk1 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,6),1)*q^nthroot(6,d)*(1-q)^nthroot((l-6),d) * size(nchoosek(1:(l-6),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_7nk2 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,5),1)*q^nthroot(5,d)*(1-q)^nthroot((l-5),d) * size(nchoosek(1:(l-5),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_7nk3 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d) * size(nchoosek(1:(l-4),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_7nk4 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-3),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_7nk5 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-2),5),1)*r^nthroot(5,d)*(1-r)^nthroot((l-5),d);
P_7nk6 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-1),6),1)*r^nthroot(6,d)*(1-r)^nthroot((l-6),d);
P_7mnk1 = size(nchoosek(1:l,5),1)*p^nthroot(5,d)*(1-p)^nthroot((l-5),d) * size(nchoosek(1:(l-5),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-6),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_7mnk2 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),5),1)*q^nthroot(5,d)*(1-q)^nthroot((l-5),d) * size(nchoosek(1:(l-6),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_7mnk3 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-2),5),1)*r^nthroot(5,d)*(1-r)^nthroot((l-5),d);
P_7mnk4 = size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-6),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_7mnk5 = size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-5),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_7mnk6 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d) * size(nchoosek(1:(l-6),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_7mnk7 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d) * size(nchoosek(1:(l-5),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_7mnk8 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-3),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_7mnk9 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-3),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_7mnk10 = size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-6),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_7mnk11 = size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-4),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_7mnk12 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-4),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_7mnk13 = size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-5),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_7mnk14 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-5),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_7mnk15 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-4),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_7 = P_7m + P_7n + P_7k + P_7mn1 + P_7mn2 + P_7mn3 + P_7mn4 + P_7mn5 + P_7mn6 + P_7mk1 + P_7mk2 + P_7mk3 + P_7mk4 + P_7mk5 + P_7mk6 + P_7nk1 + P_7nk2 + P_7nk3 + P_7nk4 + P_7nk5 + P_7nk6 + P_7mnk1 + P_7mnk2 + P_7mnk3 + P_7mnk4 + P_7mnk5 + P_7mnk6 + P_7mnk7 + P_7mnk8 + P_7mnk9 + P_7mnk10 + P_7mnk11 + P_7mnk12 + P_7mnk13 + P_7mnk14 + P_7mnk15;
P_total = P_total + P_7;
p0 = P_0/P_total;
p1 = P_1/P_total;
p2 = P_2/P_total;
p3 = P_3/P_total;
p4 = P_4/P_total;
p5 = P_5/P_total;
p6 = P_6/P_total;
p7 = P_7/P_total;
end

% m + n + k =8
if l > 7
P_8m = (1-q)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,8),1)*p^nthroot(8,d)*(1-p)^nthroot((l-8),d);
P_8n = (1-p)^nthroot(l,d) * (1-r)^nthroot(l,d) * size(nchoosek(1:l,8),1)*q^nthroot(8,d)*(1-q)^nthroot((l-8),d);
P_8k = (1-p)^nthroot(l,d) * (1-q)^nthroot(l,d) * size(nchoosek(1:l,8),1)*r^nthroot(8,d)*(1-r)^nthroot((l-8),d);
P_8mn1 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,7),1)*p^nthroot(7,d)*(1-p)^nthroot((l-7),d) * size(nchoosek(1:(l-7),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d);
P_8mn2 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,6),1)*p^nthroot(6,d)*(1-p)^nthroot((l-6),d) * size(nchoosek(1:(l-6),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d);
P_8mn3 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,5),1)*p^nthroot(5,d)*(1-p)^nthroot((l-5),d) * size(nchoosek(1:(l-5),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d);
P_8mn4 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d);
P_8mn5 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),5),1)*q^nthroot(5,d)*(1-q)^nthroot((l-5),d);
P_8mn6 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),6),1)*q^nthroot(6,d)*(1-q)^nthroot((l-6),d);
P_8mn7 = (1-r)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),7),1)*q^nthroot(7,d)*(1-q)^nthroot((l-7),d);
P_8mk1 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,7),1)*p^nthroot(7,d)*(1-p)^nthroot((l-7),d) * size(nchoosek(1:(l-7),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_8mk2 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,6),1)*p^nthroot(6,d)*(1-p)^nthroot((l-6),d) * size(nchoosek(1:(l-6),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_8mk3 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,5),1)*p^nthroot(5,d)*(1-p)^nthroot((l-5),d) * size(nchoosek(1:(l-5),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_8mk4 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_8mk5 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),5),1)*r^nthroot(5,d)*(1-r)^nthroot((l-5),d);
P_8mk6 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),6),1)*r^nthroot(6,d)*(1-r)^nthroot((l-6),d);
P_8mk7 = (1-q)^nthroot(l,d) * size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),7),1)*r^nthroot(7,d)*(1-r)^nthroot((l-7),d);
P_8nk1 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,7),1)*q^nthroot(7,d)*(1-q)^nthroot((l-7),d) * size(nchoosek(1:(l-7),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_8nk2 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,6),1)*q^nthroot(6,d)*(1-q)^nthroot((l-6),d) * size(nchoosek(1:(l-6),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_8nk3 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,5),1)*q^nthroot(5,d)*(1-q)^nthroot((l-5),d) * size(nchoosek(1:(l-5),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_8nk4 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d) * size(nchoosek(1:(l-4),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_8nk5 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-3),5),1)*r^nthroot(5,d)*(1-r)^nthroot((l-5),d);
P_8nk6 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-2),6),1)*r^nthroot(6,d)*(1-r)^nthroot((l-6),d);
P_8nk7 = (1-p)^nthroot(l,d) * size(nchoosek(1:l,1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-1),7),1)*r^nthroot(7,d)*(1-r)^nthroot((l-7),d);
P_8mnk1 = size(nchoosek(1:l,6),1)*p^nthroot(6,d)*(1-p)^nthroot((l-6),d) * size(nchoosek(1:(l-6),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-7),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_8mnk2 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),6),1)*q^nthroot(6,d)*(1-q)^nthroot((l-6),d) * size(nchoosek(1:(l-7),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_8mnk3 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-2),6),1)*r^nthroot(6,d)*(1-r)^nthroot((l-6),d);
P_8mnk4 = size(nchoosek(1:l,5),1)*p^nthroot(5,d)*(1-p)^nthroot((l-5),d) * size(nchoosek(1:(l-5),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-7),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_8mnk5 = size(nchoosek(1:l,5),1)*p^nthroot(5,d)*(1-p)^nthroot((l-5),d) * size(nchoosek(1:(l-5),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-6),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_8mnk6 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),5),1)*q^nthroot(5,d)*(1-q)^nthroot((l-5),d) * size(nchoosek(1:(l-7),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_8mnk7 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),5),1)*q^nthroot(5,d)*(1-q)^nthroot((l-5),d) * size(nchoosek(1:(l-6),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_8mnk8 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-3),5),1)*r^nthroot(5,d)*(1-r)^nthroot((l-5),d);
P_8mnk9 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-3),5),1)*r^nthroot(5,d)*(1-r)^nthroot((l-5),d);
P_8mnk10 = size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-7),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_8mnk11 = size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-5),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_8mnk12 = size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d) * size(nchoosek(1:(l-7),1),1)*r^nthroot(1,d)*(1-r)^nthroot((l-1),d);
P_8mnk13 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d) * size(nchoosek(1:(l-5),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_8mnk14 = size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),1),1)*q^nthroot(1,d)*(1-q)^nthroot((l-1),d) * size(nchoosek(1:(l-4),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_8mnk15 = size(nchoosek(1:l,1),1)*p^nthroot(1,d)*(1-p)^nthroot((l-1),d) * size(nchoosek(1:(l-1),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-4),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_8mnk16 = size(nchoosek(1:l,4),1)*p^nthroot(4,d)*(1-p)^nthroot((l-4),d) * size(nchoosek(1:(l-4),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-6),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_8mnk17 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),4),1)*q^nthroot(4,d)*(1-q)^nthroot((l-4),d) * size(nchoosek(1:(l-6),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_8mnk18 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-4),4),1)*r^nthroot(4,d)*(1-r)^nthroot((l-4),d);
P_8mnk19 = size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-6),2),1)*r^nthroot(2,d)*(1-r)^nthroot((l-2),d);
P_8mnk20 = size(nchoosek(1:l,3),1)*p^nthroot(3,d)*(1-p)^nthroot((l-3),d) * size(nchoosek(1:(l-3),2),1)*q^nthroot(2,d)*(1-q)^nthroot((l-2),d) * size(nchoosek(1:(l-5),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_8mnk21 = size(nchoosek(1:l,2),1)*p^nthroot(2,d)*(1-p)^nthroot((l-2),d) * size(nchoosek(1:(l-2),3),1)*q^nthroot(3,d)*(1-q)^nthroot((l-3),d) * size(nchoosek(1:(l-5),3),1)*r^nthroot(3,d)*(1-r)^nthroot((l-3),d);
P_8 = P_8m + P_8n + P_8k + P_8mn1 + P_8mn2 + P_8mn3 + P_8mn4 + P_8mn5 + P_8mn6 + P_8mn7 + P_8mk1 + P_8mk2 + P_8mk3 + P_8mk4 + P_8mk5 + P_8mk6 + P_8mk7 + P_8nk1 + P_8nk2 + P_8nk3 + P_8nk4 + P_8nk5 + P_8nk6 + P_8nk7 + P_8mnk1 + P_8mnk2 + P_8mnk3 + P_8mnk4 + P_8mnk5 + P_8mnk6 + P_8mnk7 + P_8mnk8 + P_8mnk9 + P_8mnk10 + P_8mnk11 + P_8mnk12 + P_8mnk13 + P_8mnk14 + P_8mnk15 + P_8mnk16 + P_8mnk17 + P_8mnk18 + P_8mnk19 + P_8mnk20 + P_8mnk21;
P_total = P_total + P_8;
p0 = P_0/P_total;
p1 = P_1/P_total;
p2 = P_2/P_total;
p3 = P_3/P_total;
p4 = P_4/P_total;
p5 = P_5/P_total;
p6 = P_6/P_total;
p7 = P_7/P_total;
p8 = P_8/P_total;
end
